name: Update reusable variables

on:
  schedule:
    - cron: '*/10 * * * *'

env:
  KIND_VERSION: ${{ vars.KIND_VERSION }}

jobs:
  update_reusable_variables:
    permissions: write-all
    runs-on: ubuntu-latest
    steps:
      - name: Update reusable variables
        uses: mikefarah/yq@dd648994340a5d03225d97abf19c9bf1086c3f07 # 4.40.5
        with:
          cmd: yq -i '.on.workflow_call.outputs.kind_version.value=env(KIND_VERSION)' ${{ github.workspace }}/.github/workflows/reusable-variables.yaml
      - name: Raise a pull request
        run: |
          gh pr create --base update-reusable-variable \
                       --head main \
                       --title '🤖 Update reusable variables' \
                       --body 'Update reusable variables. 🛠️' \
                       --label 'auto-pr' \
                       --title 'Update reusable variables.'
